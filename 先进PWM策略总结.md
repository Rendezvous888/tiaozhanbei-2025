# 先进PWM策略实现总结

## 概述

本文档总结了为35kV级联H桥储能PCS系统实现的先进PWM调制策略，包括PS-PWM、NLM和SHE-PWM三种策略的性能对比和优化建议。

## 实现的PWM策略

### 1. 相移载波SPWM (PS-PWM)

**原理：**
- 每个H桥模块使用不同相位的三角载波
- 载波相移：0, 1/N, 2/N, ..., (N-1)/N（以载波周期为单位的比例）
- 参考波（正弦波）保持同步

**特点：**
- 适合高频开关应用
- 实现简单，计算量小
- 可以有效分散开关损耗

**性能：**
- 调制比0.8时THD: 173.47%
- 输出电压范围: 0 到 ±36kV
- 开关频率: 1000Hz

### 2. 最近电平调制 (NLM)

**原理：**
- 将目标正弦波就近取整到最近的电平
- 对于40模块系统，可用电平：-40Vdc 到 +40Vdc
- 步进电压：875V

**特点：**
- 开关频率等效较低
- 适合多电平系统
- 波形质量较好

**性能：**
- 调制比0.8时THD: 116.46%
- 输出电压范围: 0 到 ±35kV
- 最佳THD性能

### 3. 选择性谐波消除PWM (SHE-PWM)

**原理：**
- 通过精确计算开关角度，选择性消除特定低次谐波
- 求解非线性方程组确定开关角
- 可以消除5次、7次、11次、13次等谐波

**特点：**
- 理论上THD最低
- 计算复杂，需要数值求解
- 开关角对调制比敏感

**性能：**
- 调制比0.6时THD: 139.53%（最佳）
- 调制比0.8时THD: 318.53%
- 输出电压范围: 0 到 ±35kV

## 性能对比分析

### THD性能排名（调制比0.8）
1. **NLM**: 116.46% - 最佳性能
2. **PS-PWM**: 173.47% - 中等性能
3. **SHE-PWM**: 318.53% - 当前实现有待优化

### 关键发现

1. **调制比影响**：
   - 低调制比（0.6-0.7）下SHE-PWM表现较好
   - 高调制比下SHE-PWM性能下降明显
   - NLM在宽调制比范围内表现稳定

2. **谐波消除效果**：
   - 消除[5,7]次谐波效果较好
   - 增加谐波消除数量（如[5,7,11,13]）在当前实现中效果不明显
   - 需要进一步优化开关角计算算法

3. **系统适用性**：
   - PS-PWM：适合高频、高精度应用
   - NLM：适合多电平、低THD要求应用
   - SHE-PWM：适合特定谐波消除要求应用

## 技术实现细节

### SHE-PWM开关角计算

**方程组：**
```
基波幅值方程: Σ(4*cos(αi)/π) = modulation_index
谐波消除方程: Σ(4*cos(h*αi)/(h*π)) = 0, h ∈ [5,7,11,13]
```

**求解方法：**
- 使用scipy.optimize.fsolve求解非线性方程组
- 初始猜测值：均匀分布的开关角
- 约束条件：0 ≤ αi ≤ π/2

**当前问题：**
- 高调制比下数值稳定性差
- 开关角解的质量需要改进
- 可能需要更先进的优化算法

### 系统参数配置

**35kV系统配置：**
- 模块数：40
- 每模块直流电压：875V
- 开关频率：1000Hz
- 电网频率：50Hz
- 总输出电压：35kV

## 优化建议

### 短期优化

1. **改进SHE-PWM算法**：
   - 使用更稳定的数值求解方法
   - 优化初始猜测值选择
   - 增加约束条件确保解的物理合理性

2. **参数调优**：
   - 针对35kV系统优化开关角计算
   - 测试不同谐波消除组合
   - 优化调制比范围

### 长期优化

1. **高级PWM策略**：
   - 实现PD/POD/APOD多载波SPWM
   - 考虑空间矢量PWM (SVPWM)
   - 研究混合调制策略

2. **自适应控制**：
   - 根据负载条件动态调整调制策略
   - 实时THD监控和策略切换
   - 机器学习优化开关角

## 结论

1. **当前最佳策略**：NLM在THD性能上表现最佳，适合35kV系统应用

2. **SHE-PWM潜力**：虽然当前实现有待优化，但理论上具有最低THD的潜力

3. **系统适用性**：40模块级联H桥系统为先进PWM策略提供了良好的硬件基础

4. **发展方向**：需要进一步优化SHE-PWM算法，并探索混合调制策略

## 文件清单

- `h_bridge_model.py`: 核心H桥模型和PWM策略实现
- `compare_advanced_pwm.py`: 三种PWM策略性能比较
- `test_she_pwm.py`: SHE-PWM功能测试
- `optimize_she_35kv.py`: 35kV系统SHE-PWM优化
- `result/`: 生成的图表和分析结果

## 下一步工作

1. 优化SHE-PWM开关角计算算法
2. 实现更多高级PWM策略
3. 进行实际硬件验证
4. 开发自适应调制策略选择算法
