# Matplotlib中文字体显示问题解决方案

## 问题描述
在Windows系统上运行包含中文的matplotlib图表时，可能会出现以下警告：
```
UserWarning: Glyph XXXX missing from font(s) DejaVu Sans.
```

这是因为matplotlib默认字体不支持中文字符显示。

## 解决方案

### 1. 自动配置（推荐）
项目已经创建了`matplotlib_config.py`配置文件，会自动检测操作系统并配置合适的中文字体：

- **Windows系统**: 优先使用黑体(SimHei)、微软雅黑(Microsoft YaHei)等
- **macOS系统**: 使用苹方(PingFang SC)、冬青黑体等
- **Linux系统**: 使用文泉驿微米黑等

### 2. 手动配置字体
如果自动配置不生效，可以手动设置：

```python
import matplotlib.pyplot as plt

# 设置中文字体
plt.rcParams['font.sans-serif'] = ['SimHei', 'Microsoft YaHei', 'SimSun']
plt.rcParams['axes.unicode_minus'] = False  # 解决负号显示问题
```

### 3. 安装中文字体
确保系统安装了以下字体之一：
- **Windows**: 黑体(SimHei)、微软雅黑(Microsoft YaHei)、宋体(SimSun)
- **macOS**: 苹方、华文黑体
- **Linux**: 文泉驿微米黑

## 使用方法

### 运行测试
```bash
python matplotlib_config.py
```
这会显示一个测试图表，验证中文字体是否正常显示。

### 在代码中使用
```python
from matplotlib_config import configure_chinese_fonts

# 在创建图表前调用
configure_chinese_fonts()

# 然后正常使用matplotlib
import matplotlib.pyplot as plt
plt.plot([1, 2, 3], [1, 4, 9])
plt.title('中文标题')
plt.show()
```

## 注意事项

1. **字体优先级**: 配置文件会按优先级尝试使用字体，如果第一个字体不可用，会自动使用下一个
2. **系统兼容性**: 不同操作系统的字体名称可能不同，配置文件会自动处理
3. **性能影响**: 字体配置只在程序启动时执行一次，不会影响运行性能

## 故障排除

### 如果仍然显示异常：
1. 检查系统是否安装了中文字体
2. 尝试重启Python环境
3. 检查matplotlib版本是否过旧
4. 在代码中打印`plt.rcParams['font.sans-serif']`查看当前字体设置

### 常见错误：
- `Font family ['SimHei'] not found`: 系统未安装黑体字体
- `Glyph missing`: 字体文件损坏或不完整

## 相关文件
- `matplotlib_config.py`: 中文字体配置文件
- `main_simulation_engine.py`: 主仿真引擎（已集成字体配置）
- `hil_verification.py`: HIL验证系统（已集成字体配置）
