# 35 kV/25 MW级联储能PCS仿真系统

## 项目概述

本项目建立了一个完整的35 kV/25 MW级联储能PCS（Power Conversion System）仿真模型，包含级联H桥拓扑、IGBT器件建模、热分析、寿命预测和控制优化等功能。

### 系统特点

- **级联H桥拓扑**: 每相40个H桥功率单元串联构成多电平变流器
- **IGBT器件建模**: 详细的开关损耗和导通损耗计算
- **热分析**: IGBT结温和壳温的动态仿真
- **寿命预测**: 基于雨流计数法的IGBT和电容寿命评估
- **控制策略**: PI控制、模型预测控制、自适应控制等
- **优化算法**: 遗传算法优化控制器参数

## 文件结构

```
tiaozhanbei/
├── main_simulation.py          # 主程序文件
├── pcs_simulation_model.py     # PCS系统主仿真模型
├── h_bridge_model.py          # H桥单元详细建模
├── control_optimization.py     # 控制策略和优化算法
├── tzb.py                     # 原始文件（保留）
├── thermal_analysis.py        # 热分析模块
└── README.md                  # 项目说明文档
```

## 系统参数

### 基本参数
- **额定功率**: 25 MW
- **并网电压**: 35 kV
- **每相H桥模块数**: 40个
- **每模块直流电压**: ~505 V
- **IGBT开关频率**: 1000 Hz
- **电网频率**: 50 Hz

### 技术指标
- **输出电压等级**: 81电平（-40到+40）
- **电压分辨率**: 505 V
- **最大调制比**: 1.0
- **功率容量**: 25 MW

## 功能模块

### 1. PCS系统建模 (`pcs_simulation_model.py`)

包含以下类：
- `PCSParameters`: 系统参数配置
- `CascadedHBridge`: 级联H桥拓扑建模
- `ThermalModel`: IGBT热模型
- `LifePrediction`: 寿命预测模型
- `BatteryManagement`: 电池管理系统
- `PCSSimulation`: 主仿真类

### 2. H桥单元建模 (`h_bridge_model.py`)

包含以下类：
- `HBridgeUnit`: 单个H桥单元建模
- `CascadedHBridgeSystem`: 级联H桥系统

功能：
- PWM调制信号生成
- 开关损耗和导通损耗计算
- 谐波频谱分析
- 相移PWM策略

### 3. 控制与优化 (`control_optimization.py`)

包含以下类：
- `PCSController`: 基本控制器（PI控制）
- `PCSDynamics`: 系统动态模型
- `PCSOptimizer`: 参数优化器
- `AdvancedControlStrategies`: 高级控制策略
- `PerformanceEvaluator`: 性能评估器

### 4. 主程序 (`main_simulation.py`)

整合所有模块，提供：
- 完整的仿真流程
- 结果可视化
- 性能报告生成
- 快速测试功能

## 安装依赖

```bash
pip install numpy matplotlib scipy pandas rainflow deap
```

### 依赖包说明
- `numpy`: 数值计算
- `matplotlib`: 图形绘制
- `scipy`: 科学计算（积分、优化）
- `pandas`: 数据处理
- `rainflow`: 雨流计数法
- `deap`: 遗传算法

## 使用方法

### 快速开始

1. **运行主程序**：
```bash
python main_simulation.py
```

2. **运行单个模块**：
```bash
# 运行H桥仿真
python h_bridge_model.py

# 运行控制仿真
python control_optimization.py

# 运行PCS主仿真
python pcs_simulation_model.py
```

### 仿真流程

1. **系统初始化**: 设置系统参数和配置
2. **H桥仿真**: 生成PWM信号和输出电压
3. **24小时运行仿真**: 模拟储能电站日常运行
4. **热分析**: 计算IGBT温度变化
5. **寿命评估**: 评估器件寿命消耗
6. **性能分析**: 计算效率和损耗
7. **结果可视化**: 生成图表和报告

## 仿真结果

### 输出文件
- `PCS_仿真报告_YYYYMMDD_HHMMSS.csv`: 仿真结果报告

### 图表内容
1. **功率曲线**: 24小时充放电功率
2. **温度曲线**: IGBT结温和壳温
3. **效率曲线**: 系统效率变化
4. **SOC曲线**: 电池荷电状态
5. **损耗曲线**: 系统损耗分析
6. **分布直方图**: 功率、温度、效率分布
7. **系统信息**: 性能指标总结

### 关键指标
- **IGBT寿命剩余**: 基于温度循环的寿命评估
- **电容寿命剩余**: 基于温度和纹波电流的寿命评估
- **平均效率**: 系统整体效率
- **最大结温**: IGBT最高工作温度
- **THD**: 输出电压总谐波失真

## 技术特点

### 1. 级联H桥拓扑
- 每相40个H桥单元串联
- 产生+V、0、-V三个电平
- 通过相移PWM减少谐波
- 支持高压大功率应用

### 2. IGBT器件建模
- 开关损耗模型（开通、关断、反向恢复）
- 导通损耗模型（IGBT和二极管）
- 热网络模型（结到壳、壳到环境）
- 温度限制和保护

### 3. 寿命预测
- 雨流计数法分析温度循环
- Coffin-Manson寿命模型
- 电容Arrhenius寿命模型
- 实时寿命消耗计算

### 4. 控制策略
- 电压环PI控制
- 电流环PI控制
- 功率直接控制
- 模型预测控制（MPC）
- 自适应控制
- 模糊控制

### 5. 优化算法
- 遗传算法优化控制器参数
- 差分进化算法
- 多目标优化（效率、寿命、响应速度）

## 应用场景

### 1. 储能电站
- 电网调峰调频
- 新能源并网支持
- 电能质量改善

### 2. 工业应用
- 大功率电机驱动
- 变频器系统
- 电力电子设备

### 3. 研究开发
- 拓扑结构优化
- 控制策略研究
- 器件选型分析
- 系统性能评估

## 扩展功能

### 1. 故障诊断
- IGBT故障检测
- 温度异常报警
- 寿命预警系统

### 2. 实时监控
- 在线参数监测
- 性能指标计算
- 数据记录和分析

### 3. 优化建议
- 运行参数优化
- 维护策略建议
- 效率提升方案

## 注意事项

1. **计算资源**: 仿真需要一定的计算时间，建议使用性能较好的计算机
2. **参数调整**: 可根据实际应用需求调整系统参数
3. **模型精度**: 当前模型为简化模型，实际应用需要更精确的参数
4. **数据验证**: 建议与实验数据对比验证模型准确性

## 技术支持

如有问题或建议，请联系开发团队。

## 版本信息

- **版本**: 1.0
- **更新日期**: 2024年
- **开发语言**: Python 3.7+
- **许可证**: MIT License

---

**注意**: 本仿真系统仅供研究和学习使用，实际工程应用需要更详细的建模和验证。 